<view class="container"><view class="product-info"><image class="product-image" src="{{product.image}}" mode="aspectFit" data-event-opts="{{[['error',[['handleImageError',['$event']]]]]}}" binderror="__e"></image><view class="info-content"><view class="info-header"><view class="info-left"><view class="title">{{product.name}}</view><view class="price">{{"¥"+product.price+"/件"}}</view></view><view class="info-right"><view data-event-opts="{{[['tap',[['toggleFavorite',['$event']]]]]}}" class="favorite-btn" bindtap="__e"><image class="favorite-icon" src="/static/products/shoucang.png"></image></view><text class="stock">库存88</text></view></view></view></view><view class="detail-section"><view class="section-title">商品详情</view><view class="detail-content"><rich-text style="{{'word-break:'+('break-all')+';'}}" nodes="{{product.detail||'暂无商品详情'}}"></rich-text></view></view><view class="bottom-bar"><view class="left-btns"><view data-event-opts="{{[['tap',[['contactSeller',['$event']]]]]}}" class="icon-btn" bindtap="__e"><image class="icon-image" src="/static/products/wenshangjai.png"></image><text class="btn-text">问商家</text></view><view data-event-opts="{{[['tap',[['showCart',['$event']]]]]}}" class="icon-btn" bindtap="__e"><image class="icon-image" src="/static/products/cart.png"></image><text class="btn-text">购物车</text><block wx:if="{{cartCount}}"><text class="badge">{{cartCount}}</text></block></view></view><view class="right-btns"><view data-event-opts="{{[['tap',[['addToCart',['$event']]]]]}}" class="add-cart-btn" bindtap="__e">加入购物车</view><view data-event-opts="{{[['tap',[['buyNow',['$event']]]]]}}" class="buy-btn" bindtap="__e">立即购买</view></view></view><block wx:if="{{showCartPopup}}"><view class="cart-popup"><view data-event-opts="{{[['tap',[['hideCart',['$event']]]]]}}" class="cart-mask" bindtap="__e"></view><view class="cart-content"><view class="cart-header"><view class="header-left"><text class="title">购物车</text><block wx:if="{{cartCount}}"><text class="cart-count">{{"(共"+cartCount+"件商品)"}}</text></block></view><block wx:if="{{$root.g0>0}}"><text data-event-opts="{{[['tap',[['clearCart',['$event']]]]]}}" class="clear" bindtap="__e">清空购物车</text></block></view><block wx:if="{{$root.g1===0}}"><view class="cart-empty"><image class="empty-image" src="/static/products/empty_cart.png" mode="aspectFit"></image><text class="empty-text">购物车还是空的</text></view></block><block wx:else><scroll-view class="cart-list" scroll-y="{{true}}"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="id"><view class="cart-item"><image src="{{item.$orig.image}}" mode="aspectFit"></image><view class="item-info"><text class="item-name">{{item.$orig.name}}</text><view class="item-bottom"><text class="item-price">{{"￥"+item.$orig.price}}</text><view class="quantity-control"><text data-event-opts="{{[['tap',[['removeFromCart',['$0','$1'],[[['cartList','id',item.$orig.id,'categoryIndex']],[['cartList','id',item.$orig.id,'productIndex']]]]]]]}}" class="minus" catchtap="__e">-</text><text class="num">{{item.$orig.quantity}}</text><text data-event-opts="{{[['tap',[['handleAddToCart',['$0','$1'],[[['cartList','id',item.$orig.id,'categoryIndex']],[['cartList','id',item.$orig.id,'productIndex']]]]]]]}}" class="{{['plus',(item.m0)?'disabled':'']}}" catchtap="__e">+</text></view></view></view></view></block></scroll-view></block><block wx:if="{{$root.g2>0}}"><view class="cart-footer"><view class="total"><text>合计：</text><text class="price">{{"￥"+totalPrice}}</text></view><view data-event-opts="{{[['tap',[['goToCheckout',['$event']]]]]}}" class="checkout-btn" bindtap="__e">去结算</view></view></block></view></view></block></view>